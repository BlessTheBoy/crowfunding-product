{"version":3,"sources":["script.js"],"names":["openMenuBtn","document","getElementById","closeMenuBtn","menuControls","nav","bookmarkBtn","main","querySelector","popupModal","successModal","modalTriggers","querySelectorAll","modalCloseTrigger","successModalCloseTrigger","bodyBlackout","cardWrap","pledgeForms","modalHeader","radios","forms","inputs","donations","backers","progress","bookmarked","donationsValue","backersValue","products","no-reward","amount","minPledge","bamboo-stand","black-stand","mahogany-stand","openMenu","classList","add","closeMenu","remove","addBookmark","console","log","lastElementChild","innerText","updateAmounts","product","numberWithCommas","value","forEach","element","dataset","concat","card","button","disabled","closeModal","modal","updateSelection","openModal","checked","focus","validatePledge","form","min","arguments","length","undefined","input","err","match","Number","x","parts","toString","split","replace","join","addEventListener","trigger","popupTrigger","radio","header","nextElementSibling","e","preventDefault","pledge","target"],"mappings":"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","file":"script.js","sourcesContent":["/***************************\r\nDom references\r\n***************************/\r\n// For nav\r\nconst openMenuBtn = document.getElementById(\"burger\");\r\nconst closeMenuBtn = document.getElementById(\"closeMenu\");\r\nconst menuControls = document.getElementById(\"menuControls\");\r\nconst nav = document.getElementById(\"nav\");\r\n\r\n// For bookmark\r\nconst bookmarkBtn = document.getElementById(\"bookmarkBtn\");\r\n\r\n// For modals\r\nconst main = document.querySelector(\"#mainContent\");\r\nconst popupModal = document.querySelector(\".popup-modal\");\r\nconst successModal = document.querySelector(\".success-modal\");\r\nconst modalTriggers = document.querySelectorAll(\".popup-trigger\");\r\nconst modalCloseTrigger = document.querySelector(\".popup-modal__close\");\r\nconst successModalCloseTrigger = document.querySelector(\r\n  \".success-modal__close\"\r\n);\r\nconst bodyBlackout = document.querySelector(\".body-blackout\");\r\nconst cardWrap = document.querySelectorAll(\".cardWrap\");\r\nconst pledgeForms = document.querySelectorAll(\".cardWrap form\");\r\nconst modalHeader = document.querySelectorAll(\".cardWrap .head\");\r\nconst radios = document.querySelectorAll(\"input[type='radio']\");\r\nconst forms = document.querySelectorAll(\".productForm form\");\r\nconst inputs = document.querySelectorAll(\r\n  \".productForm form input[type='text']\"\r\n);\r\nconst donations = document.getElementById(\"donations\");\r\nconst backers = document.getElementById(\"backers\");\r\nconst progress = document.getElementById(\"progress\");\r\n\r\n/***************************\r\nVariables\r\n***************************/\r\nlet bookmarked = false;\r\nlet donationsValue = 89914;\r\nlet backersValue = 5007;\r\n// Defining amount of products left and minimum pledges for products\r\nlet products = {\r\n  \"no-reward\": { amount: null, minPledge: 0 },\r\n  \"bamboo-stand\": { amount: 101, minPledge: 25 },\r\n  \"black-stand\": { amount: 64, minPledge: 75 },\r\n  \"mahogany-stand\": { amount: 0, minPledge: 200 },\r\n};\r\n\r\n/***************************\r\nNavbar Logic\r\n***************************/\r\nopenMenuBtn.addEventListener(\"click\", openMenu);\r\ncloseMenuBtn.addEventListener(\"click\", closeMenu);\r\n\r\nfunction openMenu() {\r\n  nav.classList.add(\"open\");\r\n  menuControls.classList.add(\"open\");\r\n}\r\nfunction closeMenu() {\r\n  nav.classList.remove(\"open\");\r\n  menuControls.classList.remove(\"open\");\r\n}\r\n\r\n/***************************\r\nBookmark Logic\r\n***************************/\r\nbookmarkBtn.addEventListener(\"click\", addBookmark);\r\n\r\nfunction addBookmark() {\r\n  if (!bookmarked) {\r\n    console.log(\"adding bookmark\");\r\n    bookmarkBtn.lastElementChild.innerText = \"Bookmarked\";\r\n    bookmarkBtn.classList.add(\"bookmarked\");\r\n    bookmarked = true;\r\n  }\r\n}\r\n\r\n/***************************\r\nModal Logic\r\n***************************/\r\n\r\n// close modals\r\nmodalCloseTrigger.addEventListener(\"click\", () => {\r\n  closeModal(popupModal);\r\n});\r\n\r\n// Close success modal\r\nsuccessModalCloseTrigger.addEventListener(\"click\", () => {\r\n  closeModal(successModal);\r\n});\r\n\r\n// Close modal when you click outside of it\r\nbodyBlackout.addEventListener(\"click\", () => {\r\n  closeModal();\r\n});\r\n\r\n// Open modal when triggers are clicked\r\nmodalTriggers.forEach((trigger) => {\r\n  trigger.addEventListener(\"click\", () => {\r\n    const product = trigger.dataset.popupTrigger;\r\n    openModal(popupModal, product);\r\n  });\r\n});\r\n\r\n// Update selected product to match selected radio button\r\nradios.forEach((radio) =>\r\n  radio.addEventListener(\"input\", () => updateSelection(radio.dataset.product))\r\n);\r\n\r\n// select product and check radio on header click\r\nmodalHeader.forEach((header) => {\r\n  header.addEventListener(\"click\", () => {\r\n    let radio = header.nextElementSibling.querySelector(\"input[type='radio']\");\r\n    radio.checked = true;\r\n    updateSelection(radio.dataset.product);\r\n  });\r\n});\r\n\r\n// Handle pledge submission, validation and updating amounts\r\nforms.forEach((form) => {\r\n  let product = form.dataset.product;\r\n  form.addEventListener(\"submit\", (e) => {\r\n    e.preventDefault();\r\n    let form = e.target;\r\n\r\n    // Validate form input\r\n    let pledge = validatePledge(form, products[`${product}`].minPledge);\r\n\r\n    if (pledge) {\r\n      // update donations\r\n      donationsValue += pledge;\r\n      backersValue += 1;\r\n      products[`${product}`].amount -= 1;\r\n\r\n      updateAmounts(product);\r\n\r\n      // Show success modal\r\n      closeModal(popupModal);\r\n      openModal(successModal);\r\n    }\r\n  });\r\n\r\n  // Auto validating pledge amounts\r\n  let input = form.querySelector(\"input[type='text']\");\r\n  input.addEventListener(\"input\", () => {\r\n    validatePledge(form, products[`${product}`].minPledge);\r\n  });\r\n});\r\n\r\n// Update amounts funtion\r\nfunction updateAmounts(product) {\r\n  donations.innerText = numberWithCommas(donationsValue);\r\n  backers.innerText = numberWithCommas(backersValue);\r\n  progress.value = donationsValue;\r\n\r\n  // update amounts\r\n  let amount = document.querySelectorAll(`.amount`);\r\n  if (product) {\r\n    // Update the product amount only\r\n    amount.forEach((element) => {\r\n      if (element.dataset.product === product) {\r\n        if (products[`${product}`].amount === 0) {\r\n          document\r\n            .querySelectorAll(`.card[data-product=${product}]`)\r\n            .forEach((card) => {\r\n              card.classList.add(\"out-of-stock\");\r\n              let button = card.querySelector(\"button\");\r\n              button.disabled = true;\r\n              button.innerText = \"Out of Stock\";\r\n            });\r\n          document\r\n            .querySelectorAll(`.cardWrap[data-product=${product}]`)\r\n            .forEach((card) => card.classList.add(\"out-of-stock\"));\r\n        }\r\n\r\n        element.innerText = products[`${product}`].amount;\r\n      }\r\n    });\r\n  } else {\r\n    // Update all product amount\r\n    amount.forEach((element) => {\r\n      if (products[`${element.dataset.product}`].amount === 0) {\r\n        document\r\n          .querySelectorAll(`.card[data-product=${product}]`)\r\n          .forEach((card) => {\r\n            card.classList.add(\"out-of-stock\");\r\n            let button = card.querySelector(\"button\");\r\n            button.disabled = true;\r\n            button.innerText = \"Out of Stock\";\r\n          });\r\n        document\r\n          .querySelectorAll(`.cardWrap[data-product=${product}]`)\r\n          .forEach((card) => card.classList.add(\"out-of-stock\"));\r\n      }\r\n\r\n      element.innerText = products[`${element.dataset.product}`].amount;\r\n    });\r\n  }\r\n}\r\n\r\n// Close modal funtion\r\nfunction closeModal(modal) {\r\n  // Remove all error messages and inputs\r\n\r\n  if (modal) {\r\n    // close specified modal\r\n    modal.classList.remove(\"is--visible\");\r\n  } else {\r\n    // close all modals\r\n    popupModal.classList.remove(\"is--visible\");\r\n    successModal.classList.remove(\"is--visible\");\r\n  }\r\n  bodyBlackout.classList.remove(\"success\");\r\n  main.classList.remove(\"success\");\r\n  bodyBlackout.classList.remove(\"is-blacked-out\");\r\n  main.classList.remove(\"modal-opened\");\r\n\r\n  // remove all selections\r\n  updateSelection();\r\n}\r\n\r\n// Open modal function\r\nfunction openModal(modal, product) {\r\n  if (product) {\r\n    updateSelection(product);\r\n  }\r\n  modal.classList.add(\"is--visible\");\r\n  bodyBlackout.classList.add(\"is-blacked-out\");\r\n  main.classList.add(\"modal-opened\");\r\n  if (modal.dataset.popupModal === \"success\") {\r\n    bodyBlackout.classList.add(\"success\");\r\n    main.classList.add(\"success\");\r\n  }\r\n}\r\n\r\n// Funtion to update selected product on modal\r\nfunction updateSelection(product) {\r\n  cardWrap.forEach((card) => {\r\n    if (product && card.dataset.product == product) {\r\n      // Check card\r\n      card.classList.add(\"checked\");\r\n      card.querySelector(\"input[type='radio']\").checked = true;\r\n\r\n      // autofocus input\r\n      card.querySelector(\"input[type='text']\").focus();\r\n    } else {\r\n      // Uncheck card, clear inputs and clear errors\r\n      card.classList.remove(\"checked\");\r\n      card.querySelector(\"input[type='radio']\").checked = false;\r\n      card.querySelector(\"input[type='text']\").value = \"\";\r\n      card.querySelector(\"form\").classList.remove(\"error\");\r\n    }\r\n  });\r\n}\r\n\r\n// Function to validate pledge amount\r\nfunction validatePledge(form, min = 0) {\r\n  // Get children elements\r\n  let input = form.querySelector(\"input[type='text']\");\r\n  let err = form.querySelector(\".errorMessage\");\r\n\r\n  if (input.value === \"\") {\r\n    form.classList.add(\"error\");\r\n    err.innerText = \"enter amount\";\r\n    return;\r\n  } else if (input.value.match(/\\D/)) {\r\n    form.classList.add(\"error\");\r\n    err.innerText = \"enter numeric characters only [0-9]\";\r\n    return;\r\n  } else if (Number(input.value) < min) {\r\n    form.classList.add(\"error\");\r\n    err.innerText = `amount must be at least $${min}`;\r\n    return;\r\n  } else {\r\n    form.classList.remove(\"error\");\r\n    err.innerText = \"\";\r\n    return Number(input.value);\r\n  }\r\n}\r\n\r\n// turn numbers to comma seperated strings\r\nfunction numberWithCommas(x) {\r\n  var parts = x.toString().split(\".\");\r\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n  return parts.join(\".\");\r\n}\r\n\r\n// Update amounts on start\r\nupdateAmounts();\r\n\r\n// Confirm script is connected\r\nconsole.log(\"script loaded\");\r\n"]}