"use strict";var openMenuBtn=document.getElementById("burger"),closeMenuBtn=document.getElementById("closeMenu"),menuControls=document.getElementById("menuControls"),nav=document.getElementById("nav"),bookmarkBtn=document.getElementById("bookmarkBtn"),main=document.querySelector("#mainContent"),popupModal=document.querySelector(".popup-modal"),successModal=document.querySelector(".success-modal"),modalTriggers=document.querySelectorAll(".popup-trigger"),modalCloseTrigger=document.querySelector(".popup-modal__close"),successModalCloseTrigger=document.querySelector(".success-modal__close"),bodyBlackout=document.querySelector(".body-blackout"),cardWrap=document.querySelectorAll(".cardWrap"),pledgeForms=document.querySelectorAll(".cardWrap form"),modalHeader=document.querySelectorAll(".cardWrap .head"),radios=document.querySelectorAll("input[type='radio']"),forms=document.querySelectorAll(".productForm form"),inputs=document.querySelectorAll(".productForm form input[type='text']"),donations=document.getElementById("donations"),backers=document.getElementById("backers"),progress=document.getElementById("progress"),bookmarked=!1,donationsValue=89914,backersValue=5007,products={"no-reward":{amount:null,minPledge:0},"bamboo-stand":{amount:101,minPledge:25},"black-stand":{amount:64,minPledge:75},"mahogany-stand":{amount:0,minPledge:200}};function triggerClick(e){"13"==(e.keyCode?e.keyCode:e.which)&&(e.target||e.srcElement).click()}function selectCard(e){var t=e.keyCode?e.keyCode:e.which;if(console.log("Enter clicked on card"),"13"==t){var o=(e.target||e.srcElement).querySelector("input[type='radio']");o.checked=!0,updateSelection(o.dataset.product)}}function openMenu(){nav.classList.add("open"),menuControls.classList.add("open")}function closeMenu(){nav.classList.remove("open"),menuControls.classList.remove("open")}function addBookmark(){bookmarked||(console.log("adding bookmark"),bookmarkBtn.lastElementChild.innerText="Bookmarked",bookmarkBtn.classList.add("bookmarked"),bookmarked=!0)}function updateAmounts(e){donations.innerText=numberWithCommas(donationsValue),backers.innerText=numberWithCommas(backersValue),progress.value=donationsValue;var t=document.querySelectorAll(".amount");e?t.forEach((function(t){t.dataset.product===e&&(0===products["".concat(e)].amount&&(document.querySelectorAll(".card[data-product=".concat(e,"]")).forEach((function(e){e.classList.add("out-of-stock");var t=e.querySelector("button");t.disabled=!0,t.innerText="Out of Stock"})),document.querySelectorAll(".cardWrap[data-product=".concat(e,"]")).forEach((function(e){return e.classList.add("out-of-stock")}))),t.innerText=products["".concat(e)].amount)})):t.forEach((function(t){0===products["".concat(t.dataset.product)].amount&&(document.querySelectorAll(".card[data-product=".concat(e,"]")).forEach((function(e){e.classList.add("out-of-stock");var t=e.querySelector("button");t.disabled=!0,t.innerText="Out of Stock"})),document.querySelectorAll(".cardWrap[data-product=".concat(e,"]")).forEach((function(e){return e.classList.add("out-of-stock")}))),t.innerText=products["".concat(t.dataset.product)].amount}))}function closeModal(e){e?e.classList.remove("is--visible"):(popupModal.classList.remove("is--visible"),successModal.classList.remove("is--visible")),bodyBlackout.classList.remove("success"),main.classList.remove("success"),bodyBlackout.classList.remove("is-blacked-out"),main.classList.remove("modal-opened"),updateSelection()}function openModal(e,t){t&&updateSelection(t),e.classList.add("is--visible"),bodyBlackout.classList.add("is-blacked-out"),main.classList.add("modal-opened"),"success"===e.dataset.popupModal&&(bodyBlackout.classList.add("success"),main.classList.add("success"),e.querySelector("button").focus())}function updateSelection(e){cardWrap.forEach((function(t){e&&t.dataset.product==e?(t.classList.add("checked"),t.querySelector("input[type='radio']").checked=!0,t.querySelector("input[type='text']").focus()):(t.classList.remove("checked"),t.querySelector("input[type='radio']").checked=!1,t.querySelector("input[type='text']").value="",t.querySelector("form").classList.remove("error"))}))}function validatePledge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e.querySelector("input[type='text']"),c=e.querySelector(".errorMessage");return""===o.value?(e.classList.add("error"),void(c.innerText="enter amount")):o.value.match(/\D/)?(e.classList.add("error"),void(c.innerText="enter numeric characters only [0-9]")):Number(o.value)<t?(e.classList.add("error"),void(c.innerText="amount must be at least $".concat(t))):(e.classList.remove("error"),c.innerText="",Number(o.value))}function numberWithCommas(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}openMenuBtn.addEventListener("click",openMenu),closeMenuBtn.addEventListener("click",closeMenu),modalCloseTrigger.addEventListener("keypress",triggerClick),cardWrap.forEach((function(e){e.addEventListener("keypress",selectCard)})),bookmarkBtn.addEventListener("click",addBookmark),modalCloseTrigger.addEventListener("click",(function(){closeModal(popupModal)})),successModalCloseTrigger.addEventListener("click",(function(){closeModal(successModal)})),bodyBlackout.addEventListener("click",(function(){closeModal()})),modalTriggers.forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.popupTrigger;openModal(popupModal,t)}))})),radios.forEach((function(e){return e.addEventListener("change",(function(){return updateSelection(e.dataset.product)}))})),modalHeader.forEach((function(e){e.addEventListener("click",(function(){var t=e.nextElementSibling.querySelector("input[type='radio']");t.checked=!0,updateSelection(t.dataset.product)}))})),forms.forEach((function(e){var t=e.dataset.product;e.addEventListener("submit",(function(e){e.preventDefault();var o=validatePledge(e.target,products["".concat(t)].minPledge);o&&(donationsValue+=o,backersValue+=1,products["".concat(t)].amount-=1,updateAmounts(t),closeModal(popupModal),openModal(successModal))})),e.querySelector("input[type='text']").addEventListener("input",(function(){validatePledge(e,products["".concat(t)].minPledge)}))})),updateAmounts(),console.log("script loaded");
//# sourceMappingURL=script.js.map